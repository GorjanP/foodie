Preheat oven to 350 degrees F (175 degrees C). Grease and flour a 9x13 inch baking pan.    
In a medium saucepan, melt chocolate and butter over low heat, stirring occasionally. Remove from the heat and add 1 cup sugar, 1 cup flour, baking powder, vanilla, 2 eggs and walnuts. Stir until well blended. Spread evenly into the bottom of the prepared pan.    
For the next layer, in a medium bowl, beat the 6 ounces of cream cheese (reserve 2 ounces of the package of cream cheese for the next layer) with the 1/2 cup of sugar, egg, 2 tablespoons of flour, 1/2 teaspoon of vanilla, and 1/4 cup of butter. Mix until fluffy and smooth. Spread evenly over the first layer.    
Sprinkle the 1/4 cup of chopped nuts and chocolate chips over the second layer. Bake for 25 to 35 minutes in the preheated oven. Then sprinkle the miniature marshmallows over the top and bake for 2 minutes longer.    
Begin to prepare the icing while the bars are in the oven. In a medium saucepan, melt together the 1/4 cup of butter, 1 square of chocolate, remaining 2 ounces of cream cheese and 1/4 cup of milk. Remove from heat and stir in 3 cups of confectioners' sugar and 1 teaspoon of vanilla. Beat until smooth. Pour over the marshmallows and swirl together. Refrigerate until firm, cut into squares.    

