Preheat oven to 350 degrees F (175 degrees C).    
Heat butter in a large ovenproof skillet over medium heat; cook and stir garlic and shallot in hot butter until shallot is softened, about 5 minutes. Stir mushrooms into shallot and garlic; cook and stir until mushrooms begin to brown, 8 to 10 minutes. Stir spinach into mushroom mixture, cover, and cook until spinach is wilted, about 5 more minutes, stirring occasionally.    
Stir in ham, cook until ham begins to brown, about 5 minutes. Pour eggs evenly into skillet and cover.    
Bake in the preheated oven until the frittata is set in the middle and lightly puffed, about 25 minutes. A knife inserted into the center of the frittata should come out clean. Sprinkle with Cheddar cheese, let stand until cheese has melted, about 5 minutes. Season with salt and black pepper.    

